# VerticalScenarioEditer

縦書き脚本（台本）制作のための Windows 向け専用エディタです。

---

## できること

- 役名と本文を並べた形式で脚本を編集
- 縦書きの見た目で編集し、そのまま A4 横向き PDF に出力
- テキストとして書き出し・読み込み（整形済みテキスト）
- 役名ごとに背景色を設定

---

## 起動方法

1. このリポジトリを開きます。
2. PowerShell で次のコマンドを実行します。

```powershell
dotnet run --project VerticalScenarioEditer/VerticalScenarioEditer.csproj
```

起動すると、縦書きの編集画面が表示されます。

---

## 基本の画面構成

- **ページ中央**: 脚本の編集エリア（縦書き）
- **上部メニュー**: ファイル操作や表示切り替え
- **下部ステータスバー**: 文字数、ページ数、モード、倍率

---

## 基本の使い方（本文モード）

### 1. 入力する

- 右側が「役名」、左側が「本文」です。
- 役名セルにカーソルを置き、登場人物名を入力します。
- 本文セルに台詞やト書きを入力します。

### 2. 改行とレコード移動

- **Enter**: 本文内で改行します。
- **空行で Enter**: 次のレコードへ移動します。
- **Ctrl+Enter**: 次のレコードを新規追加して移動します。
- **Ctrl+Shift+Enter**: 前のレコードを新規追加して移動します。

### 3. セル移動

- **Tab**: 役名セル → 本文セル
- **Shift+Tab**: 本文セル → 役名セル

---

## 便利なモード

### 概要モード

- 段組みなしで自由入力するモードです。
- **Ctrl+Enter** で手動改ページを入れられます。
- 「編集」メニューから切り替えます。

### 簡易モード

- 横書き2列（役名＋本文）で編集するモードです。
- 画面スクロール型でページ概念はありません。
- 「編集」メニューから切り替えます。

### 選択モード

- 複数レコードの範囲選択に使います。
- 編集はできません（カーソル非表示）。
- 「編集」メニューから切り替えます。

---

## 保存と読み込み

### 上書き保存

- 「ファイル」→「保存（上書き）」  
  作業中のファイルに保存します。

### 名前をつけて保存

- 「ファイル」→「名前をつけて保存」  
  新しいファイル名で保存し、作業対象も切り替わります。

### 開く

- 「ファイル」→「開く（.vse）」  
  既存の VSE ファイルを読み込みます。

### 新規作成

- 「ファイル」→「新規作成」  
  現在の作業を閉じて「無題」を作成します。

### 整形済みテキストから読み込み

- 「ファイル」→「整形済みテキストから読み込み」  
  整形ルールに沿った `.txt` を読み込みます。

---

## 出力

### PDF 出力

- 「ファイル」→「PDF 出力」  
  A4横向きで出力されます。

### テキスト出力

- 「ファイル」→「整形してテキストファイル出力」  
  役名「本文」形式で書き出します。

---

## 表示に関する設定

「表示」メニューから切り替えできます。

- ページ番号の表示
- 罫線の表示
- 改行・改ページ記号の表示（表示のみで編集対象外）

---

## よくある操作

- **ズーム**: 下部のスライダー / `Ctrl + マウスホイール`
- **Undo / Redo**: `Ctrl+Z` / `Ctrl+Y`
- **コピー**: 「編集」→「テキストをコピー」  
  - 整形してコピー  
  - セリフのみコピー

---

## 仕様の詳細

細かな仕様やルールは `Document.md` を参照してください。
